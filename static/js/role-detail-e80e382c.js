import{_ as x,r as c,X as y,a7 as F,b as d,j as N,e as P,k as B,i as C,m as U,c as h,w as n,f as r,g as V,av as D,b3 as k}from"./index-f82ec64d.js";import{A as E}from"./admin-c53e251c.js";import G from"./group-permission-7503899e.js";const O={components:{GroupPermissions:G},setup(_,o){const{rules:p}=R(),e=c(null),t=c(null),i=c(!1);y();const a=c([]),l=c([]),m=F({name:"",info:""}),u=()=>{e.value.resetFields(),t.value.getGroupPermissions()};return{form:e,rules:p,group:m,loading:i,resetForm:u,submitForm:async()=>{e.value.validate(async s=>{if(s){let b={};const w=a.value.filter(f=>Object.keys(l.value).indexOf(f)<0);try{i.value=!0,b=await E.createOneGroup(m.name,m.info,w),k.success(`${b.message}`),u()}catch(f){i.value=!1,console.error(f)}i.value=!1,o.emit("finish")}else k.error("请将信息填写完整")})},groupPermissions:t,updatePermissions:s=>{a.value=s}}}};function R(){return{rules:{info:[],name:[{validator:(p,e,t)=>{if(!e)return t(new Error("分组名称不能为空"));t()},trigger:["blur","change"],required:!0}]}}}const j={class:"main"},A={class:"w-full px-10 py-6 bg-bg_color"};function M(_,o,p,e,t,i){const a=d("el-input"),l=d("el-form-item"),m=d("group-permissions"),u=d("el-button"),g=d("el-form"),v=N("loading");return P(),B("div",j,[C("div",A,[U((P(),h(g,{ref:"form","status-icon":"",rules:e.rules,model:e.group,"label-position":"right","label-width":"100px",onSubmit:o[4]||(o[4]=D(()=>{},["prevent"]))},{default:n(()=>[r(l,{label:"分组名称",prop:"name"},{default:n(()=>[r(a,{clearable:"",modelValue:e.group.name,"onUpdate:modelValue":o[0]||(o[0]=s=>e.group.name=s)},null,8,["modelValue"])]),_:1}),r(l,{label:"分组描述",prop:"info"},{default:n(()=>[r(a,{clearable:"",modelValue:e.group.info,"onUpdate:modelValue":o[1]||(o[1]=s=>e.group.info=s)},null,8,["modelValue"])]),_:1}),r(l,null,{default:n(()=>[r(m,{title:"分配权限",ref:"groupPermissions",onUpdatePermissions:e.updatePermissions},null,8,["onUpdatePermissions"])]),_:1}),r(l,{class:"submit"},{default:n(()=>[r(u,{type:"primary",onClick:o[2]||(o[2]=s=>e.submitForm("form"))},{default:n(()=>[V("保 存")]),_:1}),r(u,{onClick:o[3]||(o[3]=s=>e.resetForm("form"))},{default:n(()=>[V("重 置")]),_:1})]),_:1})]),_:1},8,["rules","model"])),[[v,e.loading]])])])}const X=x(O,[["render",M]]);export{X as default};
